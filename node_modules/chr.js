
	exports.create = function(obj) {

		// DESCOMPRIMINDO E REFORMATANDO INFORMACOES
		var	uncompress = function(data) {
			
			var background,
				maxHeight 	= 0,
				direction	= [];
			
			for(var id1 in data.directions.direction) {
				
				direction[id1] = {
					'status': false,
					'timing': 0
				};
				
				if(data.directions.direction[id1] !== "null") {
				
					direction[id1].status	= true;
					direction[id1].timing	= (parseInt(data.directions.direction[id1].timing)/10)/2;
					direction[id1].frame	= [];
					
					for(var id2 in data.directions.direction[id1].frames.frame) {
						direction[id1].frame[id2] = {
							'height'	: 0,
							'width'		: 0,
							'top'		: 0,
							'left'		: 0
						};
						
						background							= data.directions.direction[id1].frames.frame[id2].path;
						direction[id1].frame[id2].height	= parseInt(data.directions.direction[id1].frames.frame[id2].height);
						direction[id1].frame[id2].width		= parseInt(data.directions.direction[id1].frames.frame[id2].width);
						direction[id1].frame[id2].top		= parseInt(data.directions.direction[id1].frames.frame[id2].top);
						direction[id1].frame[id2].left		= parseInt(data.directions.direction[id1].frames.frame[id2].left);
						
						if(maxHeight <= parseInt(data.directions.direction[id1].frames.frame[id2].height)) {
							maxHeight = parseInt(data.directions.direction[id1].frames.frame[id2].height);
						}
					}
				} else {
					direction[id1] = null;
				}
			}
			
			return {
				'background'	: background,
				'maxHeight'		: maxHeight,
				'direction'		: direction
			}
		};
		
		// USER
		var _id 		= obj.user._id,
			nick		= obj.user.nick,
			scenarioId	= null,
			positionY	= parseInt(obj.user.positionY),
			positionX	= parseInt(obj.user.positionX);
		
		// CHR
		var chr			= uncompress(obj.chr.data),
			display		= {};
		
		return {
			//SETTERS
			setDisplay: function(value) {
				display = value;
			},
			setScenarioId: function(value) {
				scenarioId = value;
			},
			setPositionY: function(value) {
				positionY = value;
			},
			setPositionX: function(value) {
				positionX = value;
			},
			
			//GETTERS CHR
			getId: function() {
				return _id;
			},
			getNick: function() {
				return nick;
			},
			getChr: function() {
				return chr;
			},
			getScenarioId: function() {
				return scenarioId;
			},
			getPositionY: function() {
				return positionY;
			},
			getPositionX: function() {
				return positionX;
			},
			verifyListChr: function(listChr) {
				
				var newList 	= [],
					halfHeight	= display.height,
					halfWidth	= display.width;
				
				for(var id in listChr) {
									
					if(
						listChr[id].id !== _id &&
						(((positionY - halfHeight) <= listChr[id].positionY &&
						(positionY + halfHeight) >= listChr[id].positionY &&
						(positionX - halfWidth) <= listChr[id].positionX &&
						(positionX + halfWidth) >= listChr[id].positionX) ||
						((positionY - halfHeight) <= listChr[id].newPositionY &&
						(positionY + halfHeight) >= listChr[id].newPositionY &&
						(positionX - halfWidth) <= listChr[id].newPositionX &&
						(positionX + halfWidth) >= listChr[id].newPositionX))
					) {
						
						newList.push(listChr[id]);
						
					}
					
				}
				
				return newList;
			}
		}				
	}